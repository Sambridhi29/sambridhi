<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ping Pong — Single File</title>
  <style>
    :root{--bg:#0b1220;--panel:#0f1724;--accent:#22c1ff;--muted:#9aa6b2}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
    body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--bg),#07101a);color:#e6eef6}
    .wrap{width:900px;max-width:96%;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.7)}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .title{font-weight:700;letter-spacing:0.3px}
    .controls{display:flex;gap:8px;align-items:center}
    button, a.btn{background:var(--accent);border:none;color:#05202a;padding:8px 12px;border-radius:8px;font-weight:600;cursor:pointer;text-decoration:none}
    .muted{color:var(--muted);font-size:13px}
    canvas{display:block;background:linear-gradient(180deg,#02121b 0%, #043041 100%);border-radius:8px;width:100%;height:520px}
    .info{display:flex;gap:18px;align-items:center;margin-top:10px}
    .score{font-size:18px;font-weight:700}
    .kbd{background:#071826;padding:6px 8px;border-radius:6px;font-size:13px;color:var(--muted)}
    footer{margin-top:10px;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <div class="title">Ping Pong — HTML Canvas</div>
        <div class="muted">Play against computer or another player. Built in one file.</div>
      </div>
      <div class="controls">
        <button id="startBtn">Start / Resume</button>
        <button id="resetBtn">Reset</button>
        <a class="btn" id="linkBtn" href="https://chatgpt.com/c/68ca4d8d-b054-8324-9d2b-5b8beb2d3c52" target="_blank" rel="noopener">Open ChatGPT Ping Pong Link</a>
      </div>
    </header>

    <canvas id="game" width="880" height="520"></canvas>

    <div class="info">
      <div class="score">Left: <span id="leftScore">0</span> — Right: <span id="rightScore">0</span></div>
      <div class="muted">Mode:</div>
      <select id="modeSelect">
        <option value="ai">Single-player (vs AI)</option>
        <option value="2p">Two-player</option>
      </select>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <div class="muted">Controls:</div>
        <div class="kbd">W / S (Left)</div>
        <div class="kbd">↑ / ↓ (Right)</div>
      </div>
    </div>

    <footer>
      Tip: press Space to pause.
    </footer>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const leftScoreEl = document.getElementById('leftScore');
    const rightScoreEl = document.getElementById('rightScore');
    const modeSelect = document.getElementById('modeSelect');

    let W = canvas.width, H = canvas.height;

    const paddleWidth = 12, paddleHeight = 90, paddleSpeed = 7;
    const ballRadius = 8;

    let left = {x:20, y:(H-paddleHeight)/2, vy:0};
    let right = {x:W-20-paddleWidth, y:(H-paddleHeight)/2, vy:0};
    let ball = {x:W/2, y:H/2, vx:5, vy:3, r:ballRadius};

    let leftScore = 0, rightScore = 0;
    let running = false, paused = false;

    function resetBall(servingToRight=true){
      ball.x = W/2; ball.y = H/2;
      const angle = (Math.random()*0.6 - 0.3);
      const speed = 5 + Math.random()*1.5;
      ball.vx = (servingToRight?1:-1)*speed;
      ball.vy = angle * speed * 2;
    }

    function resetAll(){
      left.y = (H-paddleHeight)/2; right.y = (H-paddleHeight)/2;
      leftScore = 0; rightScore = 0; updateScore();
      resetBall(true);
      running = false; paused = false;
    }

    function updateScore(){ leftScoreEl.textContent = leftScore; rightScoreEl.textContent = rightScore; }

    function drawRoundedRect(x,y,w,h,r){
      ctx.beginPath(); ctx.moveTo(x+r,y);
      ctx.arcTo(x+w,y,x+w,y+h,r);
      ctx.arcTo(x+w,y+h,x,y+h,r);
      ctx.arcTo(x,y+h,x,y,r);
      ctx.arcTo(x,y,x+w,y,r);
      ctx.closePath(); ctx.fill();
    }

    function draw(){
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle = 'rgba(255,255,255,0.06)';
      for(let i=10;i<H;i+=28){ ctx.fillRect(W/2-1, i, 2, 18); }
      ctx.fillStyle = '#cfefff';
      drawRoundedRect(left.x, left.y, paddleWidth, paddleHeight, 8);
      drawRoundedRect(right.x, right.y, paddleWidth, paddleHeight, 8);
      ctx.beginPath(); ctx.fillStyle = '#fff'; ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2); ctx.fill();
    }

    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }

    function step(){
      if(!running || paused) return;
      left.y += left.vy; right.y += right.vy;
      left.y = clamp(left.y, 0, H-paddleHeight);
      right.y = clamp(right.y, 0, H-paddleHeight);
      if(modeSelect.value === 'ai'){
        const target = ball.y - paddleHeight/2;
        const diff = target - right.y;
        right.vy = clamp(diff*0.12, -paddleSpeed, paddleSpeed);
        right.y += right.vy;
        right.y = clamp(right.y, 0, H-paddleHeight);
      }
      ball.x += ball.vx; ball.y += ball.vy;
      if(ball.y - ball.r < 0){ ball.y = ball.r; ball.vy *= -1; }
      if(ball.y + ball.r > H){ ball.y = H - ball.r; ball.vy *= -1; }
      if(ball.x - ball.r < left.x + paddleWidth && ball.x - ball.r > left.x){
        if(ball.y > left.y && ball.y < left.y + paddleHeight){
          ball.x = left.x + paddleWidth + ball.r;
          const rel = (ball.y - (left.y + paddleHeight/2)) / (paddleHeight/2);
          const speed = Math.hypot(ball.vx, ball.vy) * 1.03;
          ball.vx = Math.abs(speed); ball.vy = rel*speed;
        }
      }
      if(ball.x + ball.r > right.x && ball.x + ball.r < right.x + paddleWidth){
        if(ball.y > right.y && ball.y < right.y + paddleHeight){
          ball.x = right.x - ball.r;
          const rel = (ball.y - (right.y + paddleHeight/2)) / (paddleHeight/2);
          const speed = Math.hypot(ball.vx, ball.vy) * 1.03;
          ball.vx = -Math.abs(speed); ball.vy = rel*speed;
        }
      }
      if(ball.x < 0){ rightScore++; updateScore(); resetBall(true); running = true; }
      if(ball.x > W){ leftScore++; updateScore(); resetBall(false); running = true; }
    }

    function loop(){ step(); draw(); requestAnimationFrame(loop); }
    loop();

    const keys = {};
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space'){ paused=!paused; startBtn.textContent=paused?'Resume':'Pause'; } keys[e.code]=true; updateInputFromKeys(); });
    window.addEventListener('keyup', (e)=>{ keys[e.code]=false; updateInputFromKeys(); });

    function updateInputFromKeys(){
      if(keys['KeyW']) left.vy=-paddleSpeed; else if(keys['KeyS']) left.vy=paddleSpeed; else left.vy=0;
      if(modeSelect.value==='2p'){ if(keys['ArrowUp']) right.vy=-paddleSpeed; else if(keys['ArrowDown']) right.vy=paddleSpeed; else right.vy=0; }
    }

    startBtn.addEventListener('click', ()=>{ running=true; paused=false; startBtn.textContent='Pause'; });
    resetBtn.addEventListener('click', ()=>{ resetAll(); startBtn.textContent='Start / Resume'; });
    resetAll();
    canvas.addEventListener('click', ()=>{ paused=!paused; startBtn.textContent=paused?'Resume':'Pause'; });
  </script>
</body>
</html>
